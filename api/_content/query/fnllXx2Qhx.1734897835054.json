{"_path":"/blog/iis-express-localhost-ssl-certificate-reset","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"IIS Express 10 localhost SSL certificate reset","description":"Tutorial on how to reset your localhost SSL certificate for IIS Express 10.","head":{"meta":[{"name":"keywords","content":"Tutorial, how to, reset, IIS, Express, HTTPS, SSL, Certificate, .NET, API, Visual Studio, VS, Steff, Beckers, Blog"}]},"date":"2021-03-26T20:48:00Z","tags":["dev","tutorial","dotnet","visual-studio","iis-express","ssl"],"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"iis-express-10-localhost-ssl-certificate-reset"},"children":[{"type":"text","value":"IIS Express 10 localhost SSL certificate reset"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tutorial on how to reset your localhost SSL certificate for IIS Express 10."}]},{"type":"element","tag":"h2","props":{"id":"source-code"},"children":[{"type":"text","value":"Source code"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Quick test .NET Web API project to test the problem, fix the issue and check if it's working again."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/steffbeckers/iis-express-ssl-reset-test","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/steffbeckers/iis-express-ssl-reset-test"}]}]},{"type":"element","tag":"h2","props":{"id":"problem"},"children":[{"type":"text","value":"Problem"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"While running a test .NET Web API using IIS Express, the "},{"type":"element","tag":"a","props":{"href":"https://localhost","rel":["nofollow"]},"children":[{"type":"text","value":"https://localhost"}]},{"type":"text","value":":... site can't be reached or some other error like \"invalid SSL certificate\"."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"This site can't be reached screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/this-site-cant-be-reached-localhost-refused-to-connect.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"But if we run the API with Kestrel, the site just works fine."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with Kestrel screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-kestrel.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Test Web API swagger UI screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Or maybe this isn't even working for you."}]},{"type":"element","tag":"h2","props":{"id":"solution"},"children":[{"type":"text","value":"Solution"}]},{"type":"element","tag":"h3","props":{"id":"step-1-cleanup-all-localhost-certificates"},"children":[{"type":"text","value":"Step 1: Cleanup all localhost certificates"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Open the Windows Certificate Manager by searching for \"certificate\". Choose \"Manage user certificates\"."}]},{"type":"element","tag":"img","props":{"alt":"Windows search certificate screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-certificate.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Select all localhost certificates in the \"Personal/Certificates\" folder and delete them."}]},{"type":"element","tag":"img","props":{"alt":"Certificate manager user personal screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-personal.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Select all localhost certificates in the \"Trusted Root Certification Authorities/Certificates\" folder and delete them."}]},{"type":"element","tag":"img","props":{"alt":"Certificate manager user trusted root screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-trusted-root.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now do the same thing but for your local computer certificates."}]},{"type":"element","tag":"img","props":{"alt":"Windows search computer certificate screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-computer-certificate.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Certificate manager computer personal screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-personal.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Certificate manager computer trusted root screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-trusted-root.png"},"children":[]},{"type":"element","tag":"h3","props":{"id":"step-2-use-the-iis-express-admin-cli"},"children":[{"type":"text","value":"Step 2: Use the IIS Express admin CLI"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Open a new powershell or cmd prompt as Administrator (elevated permissions)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Change directory to your IIS Express installation folder."}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"cd \"C:\\Program Files (x86)\\IIS Express\"\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"cd "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"C:\\Program Files (x86)\\IIS Express\"\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now execute the following command to re-run the setup for the SSL certificates."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Make sure to "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"update the port number"}]},{"type":"text","value":" to match yours"}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"./IisExpressAdminCmd.exe setupsslUrl -url:https://localhost:44321/ -UseSelfSigned\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"IisExpressAdminCmd.exe"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" setupsslUrl "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"url:https:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"//"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"localhost:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44321"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"UseSelfSigned\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Should give the following output:"}]},{"type":"element","tag":"img","props":{"alt":"Windows Terminal reset IIS Express SSL screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-terminal-reset-iis-express-ssl.png"},"children":[]},{"type":"element","tag":"h3","props":{"id":"step-3-restart-visual-studio"},"children":[{"type":"text","value":"Step 3: Restart Visual Studio"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Make sure to restart Visual Studio, this will also stop IIS Express."}]},{"type":"element","tag":"h3","props":{"id":"step-4-re-run-your-application-with-iis-express"},"children":[{"type":"text","value":"Step 4: Re-run your application with IIS Express"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Select IIS Express in your debug/run configuration and start the application."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now you should get a pop-up to trust the new self-signed SSL certificate for your localhost app, we generated/setup in step 2. Choose \"Yes\" to trust the certificate."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express SSL pop-up screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This pop-up should follow. This is a security warning you get before installing new certificates on your local machine. Choose \"Yes\" to install the certificate."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express SSL pop-up warning screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup-warning.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After installing the certificate the app should start correctly and the SSL problem should be fixed."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now we get the \"Application started. ...\" ouput, in the Output window within Visual Studio."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express with output screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-with-output.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Navigate/browse to the web page to test if the SSL certificate is fixed."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://localhost:44321/swagger","rel":["nofollow"]},"children":[{"type":"text","value":"https://localhost:44321/swagger"}]}]},{"type":"element","tag":"img","props":{"alt":"Test Web API swagger UI screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},"children":[]},{"type":"element","tag":"h2","props":{"id":"edit-31032021"},"children":[{"type":"text","value":"Edit 31/03/2021"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Also check out this GitHub Gist:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://gist.github.com/camieleggermont/5b2971a96e80a658863106b21c479988","rel":["nofollow"]},"children":[{"type":"text","value":"https://gist.github.com/camieleggermont/5b2971a96e80a658863106b21c479988"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This powershell script generates a new certificate, removes the old certificate assignments from the IISExpress ssl ports and adds the newly generated one. The certificate is also copied over to the Trusted Root Certificate Authorities."}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"$cert = New-SelfSignedCertificate -DnsName \"localhost\", \"localhost\" -CertStoreLocation \"cert:\\LocalMachine\\My\" -NotAfter (Get-Date).AddYears(5)\n$thumb = $cert.GetCertHashString()\n\nFor ($i=44300; $i -le 44399; $i++) {\n    netsh http delete sslcert ipport=0.0.0.0:$i\n}\n\nFor ($i=44300; $i -le 44399; $i++) {\n    netsh http add sslcert ipport=0.0.0.0:$i certhash=$thumb appid=`{214124cd-d05b-4309-9af9-9caa44b2b74a`}\n}\n\n$StoreScope = 'LocalMachine'\n$StoreName = 'root'\n\n$Store = New-Object  -TypeName System.Security.Cryptography.X509Certificates.X509Store  -ArgumentList $StoreName, $StoreScope\n$Store.Open([System.Security.Cryptography.X509Certificates.OpenFlags]::ReadWrite)\n$Store.Add($cert)\n\n$Store.Close()\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$cert "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" New-SelfSignedCertificate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"DnsName "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"localhost\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" \"localhost\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"CertStoreLocation "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"cert:\\LocalMachine\\My\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"NotAfter ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"Get-Date"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":").AddYears("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$thumb "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" $cert.GetCertHashString()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"For"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" ($i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44300"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-le"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" 44399"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"    netsh http delete sslcert ipport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":":$i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"For"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" ($i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44300"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-le"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" 44399"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"    netsh http add sslcert ipport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":":$i certhash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$thumb appid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"=`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"{214124cd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"d05b"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"4309"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"9af9"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"9caa44b2b74a"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$StoreScope "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" 'LocalMachine'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$StoreName "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" 'root'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" New-Object"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"  -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"TypeName System.Security.Cryptography.X509Certificates.X509Store  "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"ArgumentList $StoreName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" $StoreScope\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Open(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"System.Security.Cryptography.X509Certificates.OpenFlags"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"]::ReadWrite)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Add($cert)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Close()\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This can help to reset all SSL certificates within the IIS Express port range 44300-44399. Make sure to open a powershell prompt as Administrator (elevated permissions)."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"source-code","depth":2,"text":"Source code"},{"id":"problem","depth":2,"text":"Problem"},{"id":"solution","depth":2,"text":"Solution","children":[{"id":"step-1-cleanup-all-localhost-certificates","depth":3,"text":"Step 1: Cleanup all localhost certificates"},{"id":"step-2-use-the-iis-express-admin-cli","depth":3,"text":"Step 2: Use the IIS Express admin CLI"},{"id":"step-3-restart-visual-studio","depth":3,"text":"Step 3: Restart Visual Studio"},{"id":"step-4-re-run-your-application-with-iis-express","depth":3,"text":"Step 4: Re-run your application with IIS Express"}]},{"id":"edit-31032021","depth":2,"text":"Edit 31/03/2021"}]}},"_type":"markdown","_id":"content:3.blog:iis-express-localhost-ssl-certificate-reset.md","_source":"content","_file":"3.blog/iis-express-localhost-ssl-certificate-reset.md","_stem":"3.blog/iis-express-localhost-ssl-certificate-reset","_extension":"md","sitemap":{"loc":"/blog/iis-express-localhost-ssl-certificate-reset","images":[{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/this-site-cant-be-reached-localhost-refused-to-connect.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-kestrel.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-certificate.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-personal.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-trusted-root.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-computer-certificate.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-personal.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-trusted-root.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-terminal-reset-iis-express-ssl.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup-warning.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-with-output.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"}]}}