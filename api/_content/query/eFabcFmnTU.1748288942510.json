{"_path":"/nl/blog/iis-express-localhost-ssl-certificate-reset","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"IIS Express 10 localhost SSL-certificaat resetten","description":"Handleiding over hoe je je localhost SSL-certificaat voor IIS Express 10 opnieuw instelt.","head":{"meta":[{"name":"keywords","content":"Handleiding, hoe, resetten, IIS, Express, HTTPS, SSL, Certificaat, .NET, API, Visual Studio, VS, Steff, Beckers, Blog"}]},"date":"2021-03-26T20:48:00Z","tags":["dev","tutorial","dotnet","visual-studio","iis-express","ssl"],"readingTime":{"text":"2 min read","minutes":1.86,"time":111600,"words":372},"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"broncode"},"children":[{"type":"text","value":"Broncode"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Snel testproject in .NET Web API om het probleem te reproduceren, op te lossen en te controleren of alles weer werkt:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/steffbeckers/iis-express-ssl-reset-test","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/steffbeckers/iis-express-ssl-reset-test"}]}]},{"type":"element","tag":"h2","props":{"id":"probleem"},"children":[{"type":"text","value":"Probleem"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tijdens het uitvoeren van een testproject in .NET Web API via IIS Express is de site op "},{"type":"element","tag":"a","props":{"href":"https://localhost","rel":["nofollow"]},"children":[{"type":"text","value":"https://localhost"}]},{"type":"text","value":":... niet bereikbaar of verschijnt een foutmelding zoals \"ongeldig SSL-certificaat\"."}]},{"type":"element","tag":"img","props":{"alt":"Visual Studio draait een Web API met IIS Express screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Deze site is niet bereikbaar screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/this-site-cant-be-reached-localhost-refused-to-connect.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Maar als we de API via Kestrel starten, werkt de site w√©l correct."}]},{"type":"element","tag":"img","props":{"alt":"Visual Studio draait een Web API met Kestrel screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-kestrel.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Test Web API swagger UI screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Of misschien werkt het voor jou zelfs dan nog niet."}]},{"type":"element","tag":"h2","props":{"id":"oplossing"},"children":[{"type":"text","value":"Oplossing"}]},{"type":"element","tag":"h3","props":{"id":"stap-1-verwijder-alle-localhost-certificaten"},"children":[{"type":"text","value":"Stap 1: Verwijder alle localhost-certificaten"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Open Windows Certificaatbeheer door te zoeken naar \"certificaat\" en kies \"Gebruikerscertificaten beheren\"."}]},{"type":"element","tag":"img","props":{"alt":"Windows zoekopdracht certificaat screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-certificate.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Verwijder alle localhost-certificaten in de map \"Persoonlijk/Certificaten\"."}]},{"type":"element","tag":"img","props":{"alt":"Certificaatbeheer gebruiker persoonlijk screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-personal.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Verwijder ook alle localhost-certificaten in \"Vertrouwde basiscertificeringsinstanties/Certificaten\"."}]},{"type":"element","tag":"img","props":{"alt":"Certificaatbeheer gebruiker vertrouwde root screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-trusted-root.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Doe nu hetzelfde voor de certificaten van de lokale computer:"}]},{"type":"element","tag":"img","props":{"alt":"Windows zoekopdracht computer certificaat screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-computer-certificate.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Certificaatbeheer computer persoonlijk screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-personal.png"},"children":[]},{"type":"element","tag":"img","props":{"alt":"Certificaatbeheer computer vertrouwde root screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-trusted-root.png"},"children":[]},{"type":"element","tag":"h3","props":{"id":"stap-2-gebruik-de-iis-express-admin-cli"},"children":[{"type":"text","value":"Stap 2: Gebruik de IIS Express admin CLI"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Open een nieuw PowerShell- of cmd-venster als Administrator (met verhoogde rechten)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Navigeer naar de IIS Express-installatiemap:"}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"cd \"C:\\Program Files (x86)\\IIS Express\"\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"cd "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"C:\\Program Files (x86)\\IIS Express\"\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Voer nu het volgende commando uit om het SSL-certificaat opnieuw in te stellen.\n"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Pas het poortnummer aan"}]},{"type":"text","value":" aan je eigen project:"}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"./IisExpressAdminCmd.exe setupsslUrl -url:https://localhost:44321/ -UseSelfSigned\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"IisExpressAdminCmd.exe"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" setupsslUrl "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"url:https:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"//"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"localhost:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44321"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"UseSelfSigned\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Je zou nu de volgende uitvoer moeten zien:"}]},{"type":"element","tag":"img","props":{"alt":"Windows Terminal reset IIS Express SSL screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-terminal-reset-iis-express-ssl.png"},"children":[]},{"type":"element","tag":"h3","props":{"id":"stap-3-herstart-visual-studio"},"children":[{"type":"text","value":"Stap 3: Herstart Visual Studio"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Zorg dat je Visual Studio opnieuw opstart, dit sluit ook IIS Express af."}]},{"type":"element","tag":"h3","props":{"id":"stap-4-start-je-applicatie-opnieuw-via-iis-express"},"children":[{"type":"text","value":"Stap 4: Start je applicatie opnieuw via IIS Express"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Selecteer IIS Express in je debug-configuratie en start de applicatie."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Je zou nu een pop-up moeten krijgen om het nieuw aangemaakte, zelfondertekende SSL-certificaat voor je localhost-app te vertrouwen. Kies \"Ja\" om het te vertrouwen."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express SSL pop-up screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Daarna volgt een beveiligingswaarschuwing. Kies \"Ja\" om het certificaat te installeren."}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express SSL pop-up warning screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup-warning.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Na installatie zou de applicatie correct moeten starten en is het SSL-probleem verholpen."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Je ziet nu de boodschap \"Application started ...\" in het Uitvoer-venster van Visual Studio:"}]},{"type":"element","tag":"img","props":{"alt":"Visual studio running a Web API with IIS Express with output screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-with-output.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Navigeer nu naar de webpagina om te testen of het SSL-certificaat werkt:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://localhost:44321/swagger","rel":["nofollow"]},"children":[{"type":"text","value":"https://localhost:44321/swagger"}]}]},{"type":"element","tag":"img","props":{"alt":"Test Web API swagger UI screenshot","src":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},"children":[]},{"type":"element","tag":"h2","props":{"id":"aanvulling-31032021"},"children":[{"type":"text","value":"Aanvulling 31/03/2021"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bekijk ook deze GitHub Gist:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://gist.github.com/camieleggermont/5b2971a96e80a658863106b21c479988","rel":["nofollow"]},"children":[{"type":"text","value":"https://gist.github.com/camieleggermont/5b2971a96e80a658863106b21c479988"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dit PowerShell-script genereert een nieuw certificaat, verwijdert oude SSL-koppelingen van IIS Express en voegt het nieuw gegenereerde certificaat toe. Het certificaat wordt ook toegevoegd aan de Trusted Root Certification Authorities."}]},{"type":"element","tag":"pre","props":{"className":"language-powershell shiki shiki-themes github-dark github-light","code":"$cert = New-SelfSignedCertificate -DnsName \"localhost\", \"localhost\" -CertStoreLocation \"cert:\\LocalMachine\\My\" -NotAfter (Get-Date).AddYears(5)\n$thumb = $cert.GetCertHashString()\n\nFor ($i=44300; $i -le 44399; $i++) {\n    netsh http delete sslcert ipport=0.0.0.0:$i\n}\n\nFor ($i=44300; $i -le 44399; $i++) {\n    netsh http add sslcert ipport=0.0.0.0:$i certhash=$thumb appid=`{214124cd-d05b-4309-9af9-9caa44b2b74a`}\n}\n\n$StoreScope = 'LocalMachine'\n$StoreName = 'root'\n\n$Store = New-Object  -TypeName System.Security.Cryptography.X509Certificates.X509Store  -ArgumentList $StoreName, $StoreScope\n$Store.Open([System.Security.Cryptography.X509Certificates.OpenFlags]::ReadWrite)\n$Store.Add($cert)\n\n$Store.Close()\n","language":"powershell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$cert "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" New-SelfSignedCertificate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"DnsName "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"localhost\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" \"localhost\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"CertStoreLocation "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":"\"cert:\\LocalMachine\\My\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"NotAfter ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"Get-Date"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":").AddYears("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$thumb "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" $cert.GetCertHashString()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"For"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" ($i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44300"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-le"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" 44399"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"    netsh http delete sslcert ipport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":":$i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"For"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" ($i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"44300"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-le"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" 44399"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"; $i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"    netsh http add sslcert ipport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"0.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":":$i certhash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$thumb appid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"=`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"{214124cd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"d05b"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":"4309"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"9af9"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"9caa44b2b74a"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$StoreScope "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" 'LocalMachine'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$StoreName "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" 'root'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" New-Object"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"  -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"TypeName System.Security.Cryptography.X509Certificates.X509Store  "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"ArgumentList $StoreName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":" $StoreScope\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Open(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49"},"children":[{"type":"text","value":"System.Security.Cryptography.X509Certificates.OpenFlags"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"]::ReadWrite)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Add($cert)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E"},"children":[{"type":"text","value":"$Store.Close()\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dit kan helpen om SSL-certificaten in de IIS Express-poortreeks 44300‚Äì44399 volledig te resetten. Vergeet niet om PowerShell als Administrator te openen."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"broncode","depth":2,"text":"Broncode"},{"id":"probleem","depth":2,"text":"Probleem"},{"id":"oplossing","depth":2,"text":"Oplossing","children":[{"id":"stap-1-verwijder-alle-localhost-certificaten","depth":3,"text":"Stap 1: Verwijder alle localhost-certificaten"},{"id":"stap-2-gebruik-de-iis-express-admin-cli","depth":3,"text":"Stap 2: Gebruik de IIS Express admin CLI"},{"id":"stap-3-herstart-visual-studio","depth":3,"text":"Stap 3: Herstart Visual Studio"},{"id":"stap-4-start-je-applicatie-opnieuw-via-iis-express","depth":3,"text":"Stap 4: Start je applicatie opnieuw via IIS Express"}]},{"id":"aanvulling-31032021","depth":2,"text":"Aanvulling 31/03/2021"}]}},"_type":"markdown","_id":"content:nl:blog:iis-express-localhost-ssl-certificate-reset.md","_source":"content","_file":"nl/blog/iis-express-localhost-ssl-certificate-reset.md","_stem":"nl/blog/iis-express-localhost-ssl-certificate-reset","_extension":"md","sitemap":{"loc":"/nl/blog/iis-express-localhost-ssl-certificate-reset","images":[{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/this-site-cant-be-reached-localhost-refused-to-connect.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-kestrel.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-certificate.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-personal.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-user-trusted-root.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-search-computer-certificate.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-personal.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/certificate-manager-computer-trusted-root.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/windows-terminal-reset-iis-express-ssl.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-ssl-popup-warning.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/visual-studio-running-web-api-with-iis-express-with-output.png"},{"loc":"/blog/iis-express-localhost-ssl-certificate-reset/images/web-api-swagger.png"}]}}